async function loadApplications() {
  const applicationsRef = db.collection("applications");
  const querySnapshot = await applicationsRef.get();
  const applicationList = document.getElementById("application-list");

  querySnapshot.forEach((docSnap) => {
    const data = docSnap.data();
    const listItem = document.createElement("div");
    listItem.classList.add("bg-white", "p-4", "rounded", "shadow");

    // timestamp가 Firestore Timestamp 객체인지 확인하고, Date로 변환
    let timestamp = data.timestamp;
    if (timestamp instanceof firebase.firestore.Timestamp) {
      timestamp = timestamp.toDate(); // Timestamp -> Date 변환
    } else {
      timestamp = "잘못된 날짜 형식"; // 오류 처리
    }

    listItem.innerHTML = `
      <div class="flex justify-between items-start">
        <h2 class="text-lg font-bold">${data.name || '신청자 미입력'}</h2>
        <span class="px-2 py-1 rounded text-sm font-medium ${getStatusClass(data.status).bg} ${getStatusClass(data.status).text}">
          ${data.status || '대기중'}
        </span>
      </div>
      <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-2">
        <div>
          <p class="text-sm text-gray-600">신청일시</p>
          <p class="font-medium">${timestamp.toLocaleString() || '-'}</p>
        </div>
        <div>
          <p class="text-sm text-gray-600">대여일자</p>
          <p class="font-medium">${data.date || '-'}</p>
        </div>
        <div>
          <p class="text-sm text-gray-600">대여시간</p>
          <p class="font-medium">${data.time || '-'}</p>
        </div>
        <div>
          <p class="text-sm text-gray-600">장비</p>
          <p class="font-medium">${data.items?.join(", ") || '없음'}</p>
        </div>
      </div>
      <div class="mt-2">
        <p class="text-sm text-gray-600">증명사진</p>
        <p>${data.proofPhoto
          ? `<a href="${data.proofPhoto}" target="_blank" class="text-blue-600 underline">보기</a>`
          : '없음'}</p>
      </div>
      <div class="mt-4 flex space-x-2">
        <button class="approve-btn px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded" data-id="${docSnap.id}">승인</button>
        <button class="reject-btn px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded" data-id="${docSnap.id}">반려</button>
      </div>
    `;
    
    applicationList.appendChild(listItem);

    // 승인 및 반려 버튼 클릭 이벤트
    listItem.querySelector('.approve-btn').addEventListener('click', () => updateApplicationStatus(docSnap.id, '승인됨'));
    listItem.querySelector('.reject-btn').addEventListener('click', () => updateApplicationStatus(docSnap.id, '반려됨'));
  });
}
