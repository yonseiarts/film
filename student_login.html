<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>학생 로그인</title>
  <!-- Tailwind CSS CDN (개발용 - 프로덕션에서는 빌드된 CSS 권장) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-auth-compat.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="bg-white shadow-md rounded-lg p-8 w-full max-w-md">
    <h1 class="text-2xl font-bold text-center text-blue-700 mb-6">🎓 학생 로그인</h1>
    <form id="loginForm" class="space-y-4">
      <input type="text" id="studentName" placeholder="이름" class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400" required>
      <input type="text" id="studentId" placeholder="학번" class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400" required>
      <input type="password" id="studentPassword" placeholder="비밀번호" class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400" required>
      <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">로그인</button>
      <p id="errorMsg" class="text-center text-sm text-red-500"></p>
    </form>
  </div>

  <script>
    // Firebase 초기화 – 실제 프로젝트 정보로 교체하세요.
    const firebaseConfig = {
      apiKey: "AIzaSyDqGToBXgmqiOBMpFSkKZOtbo4o5sCNjuQ",
      authDomain: "yonseirent-setup.firebaseapp.com",
      projectId: "yonseirent-setup",
      storageBucket: "yonseirent-setup.firebasestorage.app",
      messagingSenderId: "1072524969376",
      appId: "1:1072524969376:web:0d7aa9875341262f3e10c5",
      measurementId: "G-CQZEKPE02D"
    };
    firebase.initializeApp(firebaseConfig);

    const loginForm = document.getElementById("loginForm");
    loginForm.addEventListener("submit", function (e) {
      e.preventDefault();

      // 입력값 가져오기
      const studentName = document.getElementById("studentName").value.trim();
      const studentId = document.getElementById("studentId").value.trim();
      const studentPassword = document.getElementById("studentPassword").value.trim();

      // 이메일 구성: 학번을 소문자로 변환한 후 "@example.com" 도메인 추가  
      // (해당 이메일 계정은 Firebase Auth 콘솔에 미리 등록되어 있어야 합니다.)
      const email = studentId.toLowerCase() + "@example.com";

      // Firebase Auth 이메일/비밀번호 로그인
      firebase.auth().signInWithEmailAndPassword(email, studentPassword)
        .then(userCredential => {
          const user = userCredential.user;
          // displayName이 없으면 업데이트 (선택 사항)
          if (!user.displayName) {
            user.updateProfile({ displayName: studentName });
          }
          // 학생 로그인 정보(이름, 학번)를 localStorage에 저장
          localStorage.setItem("studentInfo", JSON.stringify({
            name: studentName,
            studentId: studentId
          }));
          // FORM 페이지로 이동
          window.location.href = "form.html";
        })
        .catch(error => {
          console.error("로그인 실패:", error);
          document.getElementById("errorMsg").textContent = "이름, 학번 또는 비밀번호가 일치하지 않습니다.";
        });
    });
  </script>
</body>
</html>
