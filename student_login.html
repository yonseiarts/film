<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>학생 로그인</title>
  <!-- Tailwind (선택 사항) -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div class="bg-white p-6 rounded shadow-md w-80">
    <h1 class="text-xl font-bold mb-4">학생 로그인</h1>

    <label class="block mb-2 font-medium">이름</label>
    <input type="text" id="studentName" class="border rounded w-full p-2 mb-4"/>

    <label class="block mb-2 font-medium">학번</label>
    <input type="text" id="studentID" class="border rounded w-full p-2 mb-4"/>

    <label class="block mb-2 font-medium">비밀번호</label>
    <input type="password" id="studentPW" class="border rounded w-full p-2 mb-6"/>

    <button
      onclick="login()"
      class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 mb-2">
      로그인
    </button>
    <button
      onclick="showChangePassword()"
      class="w-full bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400">
      비밀번호 변경
    </button>
  </div>

  <!-- 비밀번호 변경 모달/섹션 (간단 예시) -->
  <div id="changePWSection" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
    <div class="bg-white p-6 rounded shadow-md w-80">
      <h2 class="text-xl font-bold mb-4">비밀번호 변경</h2>
      <label class="block mb-2 font-medium">학번</label>
      <input type="text" id="changeID" class="border rounded w-full p-2 mb-4"/>
      <label class="block mb-2 font-medium">기존 비밀번호</label>
      <input type="password" id="oldPW" class="border rounded w-full p-2 mb-4"/>
      <label class="block mb-2 font-medium">새 비밀번호</label>
      <input type="password" id="newPW" class="border rounded w-full p-2 mb-6"/>

      <div class="flex space-x-2">
        <button
          onclick="changePassword()"
          class="flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
          변경하기
        </button>
        <button
          onclick="closeChangePassword()"
          class="flex-1 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400">
          닫기
        </button>
      </div>
    </div>
  </div>

  <script>
    // 예시: 허용된 아이디(학번) 목록 (하드코딩)
    // 구조: allowedUsers[id] = { name, password }
    let allowedUsers = {
      "AR23000501": { name: "이창민", password: "pw1234" },
      "AR23000501": { name: "이창민", password: "pw1234" },
      "20230003": { name: "박영희", password: "pw9999" }
      // 필요 시 더 추가...
    };

    function login() {
      const name = document.getElementById("studentName").value.trim();
      const id = document.getElementById("studentID").value.trim();
      const pw = document.getElementById("studentPW").value.trim();

      if (!name || !id || !pw) {
        alert("이름, 학번, 비밀번호를 모두 입력해주세요.");
        return;
      }

      // 학번이 allowedUsers에 있는지?
      if (!allowedUsers[id]) {
        alert("허용되지 않은 학번입니다.");
        return;
      }
      // 이름이 해당 학번과 일치하는지?
      if (allowedUsers[id].name !== name) {
        alert("이름이 학번과 일치하지 않습니다.");
        return;
      }
      // 비밀번호 일치 여부
      if (allowedUsers[id].password !== pw) {
        alert("비밀번호가 일치하지 않습니다.");
        return;
      }

      // 로그인 성공 → localStorage 저장
      localStorage.setItem("studentName", name);
      localStorage.setItem("studentID", id);

      // form.html로 이동
      window.location.href = "form.html";
    }

    // 비밀번호 변경 모달 열기
    function showChangePassword() {
      document.getElementById("changePWSection").classList.remove("hidden");
    }

    // 비밀번호 변경 모달 닫기
    function closeChangePassword() {
      document.getElementById("changePWSection").classList.add("hidden");
    }

    // 비밀번호 변경 로직
    function changePassword() {
      const id = document.getElementById("changeID").value.trim();
      const oldPW = document.getElementById("oldPW").value.trim();
      const newPW = document.getElementById("newPW").value.trim();

      if (!id || !oldPW || !newPW) {
        alert("학번, 기존 비밀번호, 새 비밀번호를 모두 입력해주세요.");
        return;
      }

      // 학번 존재?
      if (!allowedUsers[id]) {
        alert("허용되지 않은 학번입니다.");
        return;
      }
      // 기존 비밀번호 일치?
      if (allowedUsers[id].password !== oldPW) {
        alert("기존 비밀번호가 일치하지 않습니다.");
        return;
      }

      // 새 비밀번호로 변경
      allowedUsers[id].password = newPW;
      alert("비밀번호가 변경되었습니다. 다시 로그인해주세요.");

      // 모달 닫기
      closeChangePassword();
    }
  </script>
</body>
</html>
